apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
    name: multus
    namespace: kube-system
    # annotations:
    #     meta.helm.sh/release-name: multus
    #     meta.helm.sh/release-namespace: kube-system
    # labels:
    #     app.kubernetes.io/managed-by: Helm
spec:
    interval: 15m
    chart:
        spec:
            chart: multus
            version: 2.2.15
            sourceRef:
                kind: HelmRepository
                name: bitnami
                namespace: flux-system
            interval: 15m
    timeout: 20m
    maxHistory: 3
    driftDetection:
      mode: warn
    install:
        remediation:
            retries: 3
    upgrade:
        cleanupOnFail: true
        remediation:
            retries: 3
            remediateLastFailure: true
    uninstall:
        keepHistory: false
    values:
      config:
        cni_conf:
          clusterNetwork: ph34net
